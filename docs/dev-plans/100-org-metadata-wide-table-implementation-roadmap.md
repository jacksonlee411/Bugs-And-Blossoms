# DEV-PLAN-100ï¼šOrg æ¨¡å—å®½è¡¨é¢„ç•™å­—æ®µ + å…ƒæ•°æ®é©±åŠ¨è½åœ°å®æ–½è®¡åˆ’ä¸è·¯çº¿å›¾ï¼ˆæ‰¿æ¥ DEV-PLAN-098ï¼‰

**çŠ¶æ€**: éƒ¨åˆ†å®Œæˆï¼ˆM0~M4 å·²å®Œæˆï¼ŒM5 å¾…å®æ–½ï¼›2026-02-16 11:40 UTCï¼‰

## 1. èƒŒæ™¯ä¸ç›®æ ‡

`DEV-PLAN-098` å·²å®Œæˆâ€œæ¶æ„è¯„ä¼°â€ï¼Œç»“è®ºæ˜¯ï¼šåœ¨ PostgreSQL + å¤šç§Ÿæˆ· + æœ‰æ•ˆæœŸï¼ˆday ç²’åº¦ï¼‰åœºæ™¯ä¸‹ï¼Œé‡‡ç”¨â€œåŸç”Ÿå®½è¡¨é¢„ç•™å­—æ®µ + å…ƒæ•°æ®é©±åŠ¨ + PLAIN/DICT/ENTITY åˆ†æµï¼ˆPLAIN æ—  optionsï¼‰â€å…·å¤‡å¯è¡Œæ€§ä¸æ€§èƒ½ä¼˜åŠ¿ã€‚  
æœ¬è®¡åˆ’ï¼ˆDEV-PLAN-100ï¼‰æŠŠè¯„ä¼°ç»“è®ºè½¬åŒ–ä¸º**å¯æ‰§è¡Œçš„åˆ†é˜¶æ®µå®æ–½è·¯çº¿å›¾**ï¼Œå¹¶ä¸¥æ ¼å¯¹é½ä»“åº“ä¸å˜é‡ï¼ˆOne Door / No Tx, No RLS / Valid Time / No Legacyï¼‰ã€‚

æœ¬è®¡åˆ’çš„ç›®æ ‡ä¸æ˜¯ä¸€æ¬¡æ€§åšâ€œå…¨é‡åŠ¨æ€è¡¨å•å¹³å°â€ï¼Œè€Œæ˜¯å…ˆåœ¨ OrgUnit åšä¸€ä¸ªé£é™©å¯æ§ã€å¯éªŒè¯ã€å¯å›æ»šçš„æœ€å°é—­ç¯ï¼ˆMVPï¼‰ã€‚

## 2. è“å›¾åˆ†æç»“è®ºï¼ˆå¯¹ DEV-PLAN-098 çš„å·¥ç¨‹åŒ–æ”¶æ•›ï¼‰

### 2.1 å¯ä»¥ç›´æ¥é‡‡ç”¨çš„ç»“è®º

1. å®½è¡¨ç¨€ç–åˆ—åœ¨ PostgreSQL çš„ NULL Bitmap ä¸‹å­˜å‚¨æˆæœ¬å¯æ§ï¼Œä¼˜å…ˆäºçº¯ JSONB åšæ’åº/ç­›é€‰ã€‚  
2. ç»„ç»‡æ ‘ç»§ç»­ä»¥ `ltree` ä¸ºä¸»ï¼Œä¸æ”¹å˜ç°æœ‰å±‚çº§æŸ¥è¯¢ä¸»è·¯å¾„ã€‚  
3. æ‰©å±•å­—æ®µæŒ‰çƒ­ç‚¹é€æ­¥å»ºç´¢å¼•ï¼Œé»˜è®¤ä¸å…¨é‡å»ºç´¢å¼•ã€‚  
4. Select å­—æ®µå¿…é¡»åŒºåˆ† `DICT` ä¸ `ENTITY` ä¸¤ç±»æ•°æ®æºã€‚

### 2.2 å¿…é¡»è¡¥é½çš„ä»“åº“çº§çº¦æŸ

1. **One Door**ï¼šæ‰©å±•å­—æ®µå†™å…¥ä»å¿…é¡»èµ° `orgunit.submit_org_event(...)` / correction / rescind ä½“ç³»ï¼Œç¦æ­¢ç»•è¿‡äº‹ä»¶å†™ `org_unit_versions`ã€‚  
2. **æ˜ å°„ä¸å¯å˜**ï¼š`(tenant_uuid, field_key) -> physical_col` å¯ç”¨åä¸å¯æ”¹ï¼Œä¸å…è®¸æ§½ä½å¤ç”¨ã€‚  
3. **å†å²ä¸€è‡´æ€§å¿…é¡»æ˜¾å¼é€‰æ‹©**ï¼šDICT é‡‡ç”¨â€œå†™å…¥æ—¶ label å¿«ç…§ + code å­˜å‚¨â€ï¼›ENTITY é‡‡ç”¨â€œå­˜ ID + as-of joinâ€ã€‚  
4. **åŠ¨æ€ SQL å¿…é¡» allowlist + å‚æ•°åŒ–**ï¼šä»…å…è®¸å…ƒæ•°æ®è¡¨ä¸­ç™»è®°çš„ç‰©ç†åˆ—å‚ä¸æŸ¥è¯¢æ„é€ ã€‚
5. **å­—æ®µé…ç½®å†™å…¥å£å”¯ä¸€**ï¼š`tenant_field_configs` çš„æ–°å¢/å¯åœ/åœç”¨å¿…é¡»èµ°å•ä¸€ç®¡ç†å…¥å£ï¼ˆKernel å‡½æ•°ï¼‰ï¼Œç¦æ­¢åº”ç”¨è§’è‰²ç›´æ¥ DMLã€‚  
6. **No Tx, No RLS**ï¼šæ–°å¢å…ƒæ•°æ®è¡¨å¿…é¡»å¯ç”¨å¹¶å¼ºåˆ¶ RLSï¼Œä¸”æ‰€æœ‰è®¿é—®éƒ½è¦æ±‚æ˜¾å¼äº‹åŠ¡ + ç§Ÿæˆ·æ³¨å…¥ï¼Œfail-closedã€‚

### 2.3 æœ¬æœŸè½åœ°è¾¹ç•Œï¼ˆMVPï¼‰

- ä»…è¦†ç›– OrgUnit æ‰©å±•å­—æ®µï¼ˆå…ˆ 2~5 ä¸ªå­—æ®µï¼‰ã€‚
- ç±»å‹ä»…æ”¯æŒï¼š`text / int / uuid / bool / date`ã€‚
- ä»…æ”¯æŒå•å€¼å­—æ®µï¼Œä¸æ”¯æŒå¤šå€¼é›†åˆã€å…¬å¼å­—æ®µã€è·¨æ¨¡å—å†™æ—¶è”åŠ¨ã€‚
- ä»…åœ¨ OrgUnit è¯¦æƒ…é¡µ/åˆ—è¡¨é¡µå¼€æ”¾è¯»å–é—­ç¯ï¼›é«˜çº§æŠ¥è¡¨ä¸è·¨æ¨¡å—å¤ç”¨åç½®ã€‚

## 3. èŒƒå›´ä¸éç›®æ ‡

### 3.1 èŒƒå›´ï¼ˆIn Scopeï¼‰

- OrgUnit æ‰©å±•å­—æ®µå…ƒæ•°æ®æ¨¡å‹ï¼ˆå­—æ®µå®šä¹‰ã€æ§½ä½æ˜ å°„ã€æ•°æ®æºé…ç½®ã€ç”Ÿå‘½å‘¨æœŸï¼‰ã€‚
- å®½è¡¨æ‰©å±•åˆ—åœ¨ `orgunit.org_unit_versions` çš„æœ€å°å¢é‡ã€‚
- å†™å…¥é“¾è·¯ï¼šCreate/Correct äº‹ä»¶æ”¯æŒæ‰©å±•å­—æ®µ payload å¹¶åŒæ­¥æŠ•å°„ã€‚
- è¯»å–é“¾è·¯ï¼šè¯¦æƒ…è¯»å–ã€åˆ—è¡¨ç­›é€‰/æ’åºï¼ˆä»…ç™½åå•å­—æ®µï¼‰ã€‚
- èƒ½åŠ›å¤–æ˜¾ï¼šmutation capabilitiesï¼ˆæ‰¿æ¥ `DEV-PLAN-083`ï¼Œå« `deny_reasons`ï¼‰ä¸æ‰©å±•å­—æ®µ `filter/sort/options` allowlistã€‚
- Options æ¥å£ï¼šDICT ä¸ ENTITY åŒé€šé“è¯»å–ï¼ˆPLAIN æ—  optionsï¼‰ã€‚
- å­—æ®µé…ç½®ç®¡ç†ï¼šç®¡ç†ç«¯å­—æ®µå¯ç”¨/åœç”¨çš„ API + UIï¼ˆUI IA è§ `DEV-PLAN-101`ï¼‰ã€‚

### 3.2 éç›®æ ‡ï¼ˆOut of Scopeï¼‰

- ä¸æ”¹å†™ OrgUnit äº‹ä»¶æ¨¡å‹ä¸»è¯­ä¹‰ï¼ˆCREATE/MOVE/RENAME/â€¦ï¼‰ã€‚
- ä¸å¼•å…¥ç¬¬äºŒå†™å…¥å£ï¼Œä¸å¼•å…¥ legacy å…¼å®¹åŒé“¾è·¯ã€‚
- ä¸åœ¨æœ¬è®¡åˆ’å®ç°â€œä»»æ„æ¨¡å—é€šç”¨å…ƒæ•°æ®å¹³å°â€ã€‚
- ä¸åš per-tenant indexã€ä¹Ÿä¸åšè‡ªåŠ¨ç´¢å¼•ç”Ÿæˆå™¨ã€‚

## 4. å…³é”®è®¾è®¡å†³ç­–ï¼ˆå†»ç»“é¡¹ï¼‰

### D1. æ‰©å±•åˆ—è½ç‚¹

- æ‰©å±•åˆ—è½åœ¨ `orgunit.org_unit_versions`ï¼ˆè¯»æ¨¡å‹ï¼‰ã€‚
- `orgunit.org_events.payload` ä¿ç•™æ‰©å±•å­—æ®µåŸå§‹æäº¤å€¼ï¼Œç”¨äºå®¡è®¡ä¸é‡æ”¾ã€‚

### D2. æ§½ä½ä¸æ˜ å°„è§„åˆ™

- é‡‡ç”¨å›ºå®šæ§½ä½å‘½åï¼ˆç¤ºä¾‹ï¼‰ï¼š`ext_str_01..ext_str_30`ã€`ext_int_01..ext_int_10`ã€`ext_uuid_01..ext_uuid_10`ã€`ext_bool_01..ext_bool_10`ã€`ext_date_01..ext_date_10`ã€‚
- å…ƒæ•°æ®å¯ç”¨åä¸å¯å˜æ›´ `physical_col`ï¼›åœç”¨ä¸ç­‰äºå¯å¤ç”¨ã€‚
- `field_key` å½¢çŠ¶å†»ç»“ï¼ˆç”¨äº `payload.ext` çš„ keyï¼›å¿…é¡»å¯æšä¸¾ã€å¯æ ¡éªŒã€å¯é˜²æ³¨å…¥ï¼‰ï¼š
  - ä»…å…è®¸ `^[a-z][a-z0-9_]{0,62}$`ï¼›
  - ç¦æ­¢åŒ…å« `.`ï¼ˆä¿ç•™ç»™ `ext.<field_key>` dot-path è¯­ä¹‰ï¼‰ï¼›
  - å­—æ®µå®šä¹‰æ¸…å•ä¸å¾—åŒ…å«ä¸åŸºç¡€å­—æ®µå†²çªçš„ keyï¼ˆä¾‹å¦‚ `name/effective_date/org_code/...`ï¼‰ï¼Œé¿å… UI/æœåŠ¡ç«¯å‡ºç°è·¯å¾„æ­§ä¹‰ï¼›å†²çªå¿…é¡»åœ¨å¯ç”¨é˜¶æ®µ fail-closed æ‹’ç»ï¼ˆé˜²çº¿ä¸é”™è¯¯ç å£å¾„ä»¥ Phase 1/3 SSOT ä¸ºå‡†ï¼‰ã€‚

### D3. PLAIN/DICT/ENTITYï¼ˆæ•°æ®æºä¸å±•ç¤ºç­–ç•¥ï¼‰

- `PLAIN`ï¼šæ—  optionsï¼›versions ç›´æ¥å­˜å€¼ï¼›äº‹ä»¶ payload ä¸éœ€è¦ä¹Ÿä¸æ¥å—è¯¥å­—æ®µçš„ label å¿«ç…§ï¼ˆå¦‚å‡ºç°åˆ™è§†ä¸ºéæ³•è¾“å…¥ï¼‰ã€‚  
- `DICT`ï¼šversions å­˜ `code`ï¼ˆé€šå¸¸è¿›å…¥ `ext_str_xx`ï¼‰ï¼Œäº‹ä»¶ payload åŒæ—¶å†™ `ext_labels_snapshot`ï¼ˆæŒ‰å­—æ®µ key å­˜ labelï¼‰ã€‚  
  - `dict_code`ï¼ˆ`data_source_config`ï¼‰ç”± `field-definitions` æä¾›å€™é€‰ï¼Œå¯ç”¨å­—æ®µæ—¶ç”±ç§Ÿæˆ·ç®¡ç†å‘˜é€‰æ‹©å¹¶å†™å…¥ `tenant_field_configs`ï¼›å¯ç”¨åä¸å¯ä¿®æ”¹ã€‚  
  - `label` å£å¾„å†»ç»“ä¸º **canonical labelï¼ˆéæœ¬åœ°åŒ–å±•ç¤ºåï¼‰**ï¼šç”¨äº `ext_labels_snapshot` ä¸ options è¿”å›å€¼ï¼›ä¸éš UI locale å˜åŒ–ï¼ˆé¿å…å¼•å…¥â€œä¸šåŠ¡æ•°æ®å¤šè¯­è¨€â€ï¼Œè¾¹ç•Œè§ `DEV-PLAN-020`ï¼‰ã€‚  
- `ENTITY`ï¼šversions å­˜ä¸»é”® IDï¼ˆ`ext_int_xx` æˆ– `ext_uuid_xx`ï¼‰ï¼Œå±•ç¤ºæ—¶æŒ‰ `as_of` join å®ä½“è¡¨æ‹¿ labelã€‚
  - `entity/id_kind`ï¼ˆ`data_source_config`ï¼‰ç”± `field-definitions` æä¾›å€™é€‰ï¼Œå¯ç”¨å­—æ®µæ—¶ç”±ç§Ÿæˆ·ç®¡ç†å‘˜é€‰æ‹©å¹¶å†™å…¥ `tenant_field_configs`ï¼›å¯ç”¨åä¸å¯ä¿®æ”¹ã€‚

### D4. å†å²ä¸€è‡´æ€§ç­–ç•¥

- DICTï¼š`orgunit.org_events.payload` å†™å…¥ `ext_labels_snapshot`ï¼ŒæŠ•å°„æ—¶åŒæ­¥å†™å…¥ `orgunit.org_unit_versions.ext_labels_snapshot`ï¼›è¯»å–ä¼˜å…ˆçº§å›ºå®šä¸º `versions å¿«ç…§ -> events å¿«ç…§ -> å½“å‰å­—å…¸ labelï¼ˆå…¼å®¹å…œåº•å¹¶æ‰“å®¡è®¡æ ‡è®°ï¼‰`ã€‚
  - â€œå®¡è®¡æ ‡è®°â€å†»ç»“ä¸ºå¯¹å¤–å¯è§çš„æ¥æºæ ‡è¯†ï¼ˆä¾‹å¦‚ details è¿”å› `display_value_source`ï¼‰ï¼Œç”¨äº UI æ˜¾å¼æç¤ºå…œåº•è·¯å¾„ï¼›ç¦æ­¢é™é»˜â€œå½“å‰åç§°è¦†ç›–å†å²â€ï¼ˆSSOTï¼šPhase 3 çš„ `DEV-PLAN-100D`ï¼‰ã€‚
- ENTITYï¼šä¸¥æ ¼ `as_of` æŸ¥è¯¢ï¼Œç¦æ­¢â€œå½“å‰åç§°è¦†ç›–å†å²â€ã€‚

### D5. å®‰å…¨ä¸å¯è§‚æµ‹

- æ‰€æœ‰æ‰©å±•å­—æ®µæŸ¥è¯¢éƒ½å¿…é¡»ç»è¿‡æœåŠ¡ç«¯ capability/allowlist æ ¡éªŒã€‚  
- è®°å½•å®¡è®¡æ—¥å¿—å­—æ®µï¼š`tenant_uuid`ã€`field_key`ã€`physical_col`ã€`query_mode(filter/sort/options)`ã€‚

### D6. å­—æ®µé…ç½®ç”Ÿå‘½å‘¨æœŸä¸æ—¶é—´è¯­ä¹‰

- å­—æ®µé…ç½®çš„ä¸šåŠ¡ç”Ÿæ•ˆæ—¶é—´ä½¿ç”¨ **day ç²’åº¦**ï¼ˆ`enabled_on/disabled_on` ä¸º `date`ï¼‰ï¼›`created_at/updated_at/disabled_at` ä»…ç”¨äºå®¡è®¡æ—¶é—´ï¼ˆ`timestamptz`ï¼‰ã€‚
- å†™å…¥æ ¡éªŒæŒ‰ `effective_date` è§£é‡Šå­—æ®µé…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼›è¯»å–ï¼ˆè¯¦æƒ…/åˆ—è¡¨/optionsï¼‰æŒ‰ `as_of` è§£é‡Šå­—æ®µå¯è§æ€§ï¼šå½“ `as_of >= disabled_on` æ—¶è¯¥å­—æ®µä¸å±äº enabled é›†åˆï¼Œå› æ­¤ details çš„ `ext_fields[]` ä¸è¿”å›/ä¸å±•ç¤ºè¯¥å­—æ®µï¼›è‹¥éœ€æŸ¥çœ‹å†å²å€¼ï¼Œåº”åˆ‡æ¢ `as_of` æˆ–æŸ¥çœ‹ Auditï¼ˆå˜æ›´æ—¥å¿—ï¼‰ã€‚

### D7. allowlist å•ä¸€äº‹å®æºï¼ˆSSOTï¼‰

- æ‰©å±•å­—æ®µ `filter/sort/options` çš„èƒ½åŠ›åˆ¤æ–­ç»Ÿä¸€ç”±æœåŠ¡å±‚èƒ½åŠ›è§£æå™¨äº§å‡ºï¼ˆæ‰¿æ¥ `DEV-PLAN-083` â€œç­–ç•¥å•ç‚¹/èƒ½åŠ›å¤–æ˜¾â€åŸåˆ™ï¼‰ï¼Œç¦æ­¢åœ¨ API/SQL å±‚é‡å¤ç»´æŠ¤ç¬¬äºŒå¥—ç™½åå•ã€‚
- `data_source_config` ä¸å…è®¸é€ä¼ ä»»æ„è¡¨å/åˆ—åï¼›ä»…å…è®¸æšä¸¾åŒ–å®ä½“æ ‡è¯† + é¢„å®šä¹‰ SQL æ¨¡æ¿æ˜ å°„ã€‚

### D8. Mutation capabilities ä¸ Query allowlist ç»Ÿä¸€ï¼ˆæ‰¿æ¥ DEV-PLAN-083ï¼‰

- OrgUnit çš„å†™å…¥åŠ¨ä½œèƒ½åŠ›ï¼ˆmutationï¼šcreate/event_update/correct*/rescind*ï¼‰ä¸æŸ¥è¯¢èƒ½åŠ›ï¼ˆqueryï¼šfilter/sort/optionsï¼‰å¿…é¡»é€šè¿‡åŒä¸€â€œèƒ½åŠ›è§£æå™¨/ç­–ç•¥çŸ©é˜µâ€äº§å‡ºï¼›UI/API/SQL ä¸å¾—å„è‡ªç»´æŠ¤ç¬¬äºŒå¥—ç™½åå•ã€å­—æ®µæ˜ å°„æˆ–ç»„åˆçº¦æŸã€‚
- å¯¹æ‰©å±•å­—æ®µï¼Œèƒ½åŠ›è§£æå™¨å¿…é¡»å¯è¯æ˜åœ°äº§å‡ºå¹¶è§£é‡Šï¼š`field_key -> payload_key`ï¼ˆå†™å…¥ï¼‰ä¸ `field_key -> physical_col`ï¼ˆæŸ¥è¯¢ï¼‰æ˜ å°„ï¼Œä¸”ä¸¤è€…å‡ fail-closedã€‚
- `GET /org/api/org-units/mutation-capabilities`ï¼ˆè¯¦è§ `DEV-PLAN-083`ï¼‰å¿…é¡»è¦†ç›–æ‰©å±•å­—æ®µï¼šè¿”å› `allowed_fields`ã€`field_payload_keys` ä¸ `deny_reasons`ï¼Œç”¨äº UI ç¦ç”¨/éšè—ä¸åŸå› è§£é‡Šã€‚
- API ä¸å¯ç”¨æˆ–è§£æå¤±è´¥æ—¶ï¼ŒUI å¿…é¡» fail-closedï¼ˆåªè¯»/ç¦ç”¨ï¼‰ï¼Œä¸åšä¹è§‚æ”¾è¡Œã€‚

## 5. åˆ†é˜¶æ®µå®æ–½è·¯çº¿å›¾

## Phase 0ï¼šå¥‘çº¦å†»ç»“ä¸å°±ç»ªæ£€æŸ¥ï¼ˆå…ˆæ–‡æ¡£åä»£ç ï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100a-org-metadata-wide-table-phase0-contract-freeze-readiness.md`ã€‚

## Phase 1ï¼šSchema ä¸å…ƒæ•°æ®éª¨æ¶ï¼ˆæœ€å°æ•°æ®åº“é—­ç¯ï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100b-org-metadata-wide-table-phase1-schema-and-metadata-skeleton.md`ã€‚

## Phase 2ï¼šKernel/Projection æ‰©å±•ï¼ˆä¿æŒ One Doorï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100c-org-metadata-wide-table-phase2-kernel-projection-extension-one-door.md`ã€‚

## Phase 3ï¼šæœåŠ¡å±‚ä¸ APIï¼ˆè¯»å†™å¯ç”¨ï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100d-org-metadata-wide-table-phase3-service-and-api-read-write.md`ã€‚

## Phase 4ï¼šUI é›†æˆï¼ˆç”¨æˆ·å¯è§é—­ç¯ï¼‰

> å®æ–½ä¼˜å…ˆçº§å»ºè®®ï¼šå…ˆå®Œæˆ **4Aï¼ˆè¯¦æƒ…é¡µç¼–è¾‘æ€èƒ½åŠ›å¤–æ˜¾ï¼Œæ¶ˆé™¤â€œå¯è¾“å¿…è´¥â€ï¼‰**ï¼Œå†è¡¥é½ **4Bï¼ˆå­—æ®µé…ç½®ç®¡ç†é¡µå¯å‘ç°æ€§ï¼‰**ï¼Œæœ€åæ”¶å£ **4Cï¼ˆåˆ—è¡¨èƒ½åŠ› + i18nï¼‰**ã€‚  
> ä¸ºæ”¯æŒ 4A å¼€å‘ï¼Œå­—æ®µé…ç½®å¯ä¸´æ—¶é€šè¿‡ Phase 3 çš„ç®¡ç†æ¥å£åˆ›å»ºï¼›ä½† Phase 4 å‡ºå£å¿…é¡»åŒ…å« 4B é¡µé¢ä»¥æ»¡è¶³â€œé…ç½®å­—æ®µâ€ç«¯åˆ°ç«¯è·¯å¾„å¯å‘ç°ã€‚

### 4Aï¼šè¯¦æƒ…é¡µç¼–è¾‘æ€èƒ½åŠ›å¤–æ˜¾ï¼ˆæ‰¿æ¥ DEV-PLAN-083ï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100e-org-metadata-wide-table-phase4a-orgunit-details-capabilities-editing.md`ã€‚

1. [x] OrgUnit è¯¦æƒ…é¡µå±•ç¤ºæ‰©å±•å­—æ®µï¼ˆæŒ‰å­—æ®µé…ç½®åŠ¨æ€æ¸²æŸ“ï¼‰ã€‚
2. [x] è¯¦æƒ…é¡µç¼–è¾‘æ€ä¸¥æ ¼æŒ‰ mutation capabilities æ§åˆ¶å­—æ®µå¯ç¼–è¾‘æ€§ã€åŠ¨ä½œå¯ç”¨æ€§ä¸åŸå› è§£é‡Šï¼ˆ`deny_reasons`ï¼‰ï¼›æ¥å£ä¸å¯ç”¨æ—¶ fail-closedï¼ˆåªè¯»/ç¦ç”¨ï¼‰ã€‚
3. [x] Select å­—æ®µæ¥å…¥ options endpointï¼ˆDICT/ENTITY åŒé€šé“ï¼‰ã€‚

### 4Bï¼šå­—æ®µé…ç½®ç®¡ç†é¡µï¼ˆç”±DEV-PLAN-101æ‰¿æ¥ï¼‰

4. [x] å­—æ®µé…ç½®ç®¡ç†é¡µï¼ˆUIï¼‰å¯å‘ç°ä¸”å¯æ“ä½œï¼ˆä»…ç®¡ç†å‘˜å¯è§/å¯è¾¾ï¼›å¯ç”¨/åœç”¨ï¼›æ˜ å°„æ§½ä½åªè¯»ï¼‰ï¼ŒIA/é¡µé¢ç»“æ„ä»¥ `DEV-PLAN-101` ä¸ºå‡†ã€‚

### 4Cï¼šåˆ—è¡¨èƒ½åŠ›ä¸ i18nï¼ˆé—­ç¯æ”¶å£ï¼‰

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100g-org-metadata-wide-table-phase4c-orgunits-list-ext-query-i18n-closure.md`ã€‚

5. [x] OrgUnit åˆ—è¡¨é¡µå¼€æ”¾ 1~2 ä¸ªæ‰©å±•å­—æ®µç­›é€‰/æ’åºå…¥å£ã€‚
6. [x] i18nï¼ˆen/zhï¼‰è¡¥é½æ‰©å±•å­—æ®µæ ‡ç­¾ä¸é”™è¯¯æç¤ºã€‚

**å‡ºå£æ¡ä»¶**ï¼š
- ç”¨æˆ·å¯åœ¨é¡µé¢å®Œæˆâ€œå­—æ®µé…ç½®ç®¡ç†ï¼ˆå¯ç”¨å­—æ®µï¼‰-> å†™å…¥å€¼ -> åˆ—è¡¨ç­›é€‰/æ’åº -> è¯¦æƒ…å›æ˜¾â€è‡³å°‘ä¸€æ¡ç«¯åˆ°ç«¯è·¯å¾„ã€‚
- é¡µé¢åœ¨å­—æ®µæœªç”Ÿæ•ˆ/å·²åœç”¨æ—¶ç»™å‡ºæ˜ç¡®ç¦ç”¨åŸå› ï¼ˆä¸å…è®¸é™é»˜æ”¾è¡Œï¼‰ã€‚
- å­—æ®µé…ç½®ç®¡ç†é¡µåœ¨ç§Ÿæˆ· App å†…å¯å‘ç°ï¼ˆå¯¼èˆª/é¡µé¢å…¥å£ï¼‰ä¸”æƒé™ fail-closedï¼ˆæ— æƒé™ç»Ÿä¸€æ‹’ç»ï¼‰ã€‚

## Phase 5ï¼šç¨³å®šåŒ–ä¸æ€§èƒ½æ”¶å£

å·²æ‹†åˆ†ä¸ºç‹¬ç«‹å®æ–½è®¡åˆ’ï¼ˆSSOTï¼‰ï¼š`docs/dev-plans/100h-org-metadata-wide-table-phase5-stability-performance-ops-closure.md`ã€‚

1. [ ] åŸºäºæ…¢æŸ¥è¯¢ä¸çœŸå®è®¿é—®è¯æ®è¡¥å……ç´¢å¼•ï¼Œä¸åšé¢„é˜²æ€§å…¨é‡ç´¢å¼•ã€‚  
2. [ ] å¢åŠ åŸºå‡†å¯¹æ¯”ï¼ˆè‡³å°‘ï¼šåˆ—è¡¨æ’åºã€ç­›é€‰ã€è¯¦æƒ…è¯»å–ï¼‰ã€‚  
3. [ ] è¡¥é½å¼‚å¸¸åœºæ™¯ï¼šæ§½ä½è€—å°½ã€æ˜ å°„å†²çªã€ENTITY ä¸å­˜åœ¨ã€DICT å¿«ç…§ç¼ºå¤±ã€‚  
4. [ ] å½¢æˆè¿ç»´æ‰‹å†Œï¼šå­—æ®µå¯åœã€å›æ»šç­–ç•¥ã€æ•…éšœæ’æŸ¥æ­¥éª¤ã€‚

**å‡ºå£æ¡ä»¶**ï¼šP95/P99 å»¶è¿Ÿä¸é”™è¯¯ç‡è¾¾åˆ°å›¢é˜Ÿå¯æ¥å—é˜ˆå€¼ï¼ˆé˜ˆå€¼ç”±è¯„å®¡ä¼šå†»ç»“åè¡¥å……ï¼‰ã€‚

## 6. é‡Œç¨‹ç¢‘äº¤ä»˜ç‰©ï¼ˆæŒ‰é˜¶æ®µï¼‰

- M0ï¼ˆPhase 0ï¼‰ï¼šå¥‘çº¦å†»ç»“ç‰ˆæ–‡æ¡£ï¼ˆSSOTï¼š`DEV-PLAN-100A`ï¼‰+ å­—æ®µæ¸…å•ã€‚âœ…  
- M1ï¼ˆPhase 1ï¼‰ï¼šè¿ç§»è„šæœ¬ï¼ˆSSOTï¼š`DEV-PLAN-100B`ï¼‰+ å…ƒæ•°æ®è¡¨ + æ‰©å±•åˆ— + åŸºç¡€çº¦æŸã€‚âœ…  
- M2ï¼ˆPhase 2ï¼‰ï¼šKernel/Projection æ”¯æŒæ‰©å±•å­—æ®µå†™å…¥ä¸å›æ”¾ï¼ˆSSOTï¼š`DEV-PLAN-100C`ï¼‰ã€‚âœ…  
- M3ï¼ˆPhase 3ï¼‰ï¼šAPI å¯è¯»å†™ + options + mutation-capabilities + åˆ—è¡¨ç­›é€‰/æ’åºï¼ˆSSOTï¼š`DEV-PLAN-100D`ï¼‰ã€‚âœ…  
- M4ï¼ˆPhase 4ï¼‰ï¼šUI å¯æ“ä½œé—­ç¯ï¼ˆå­—æ®µé…ç½®ç®¡ç†é¡µ + è¯¦æƒ…é¡µ capabilities é©±åŠ¨ç¼–è¾‘ + åˆ—è¡¨ç­›é€‰/æ’åºï¼‰ã€‚âœ…  
- M5ï¼ˆPhase 5ï¼‰ï¼šæ€§èƒ½ä¸ç¨³å®šæ€§æŠ¥å‘Šã€‚ğŸŸ¡ï¼ˆå¾…å®æ–½ï¼‰

## 7. éªŒæ”¶æ ‡å‡†ï¼ˆDoDï¼‰

1. [x] ä¸æ–°å¢ç¬¬äºŒå†™å…¥å£ï¼Œæ‰€æœ‰å†™æ“ä½œå¯è¿½æº¯åˆ° `submit_*` å†…æ ¸å‡½æ•°ã€‚  
2. [x] æ‰©å±•å­—æ®µåœ¨æœ‰æ•ˆæœŸåˆ‡æ¢ä¸‹è¯»å†™ä¸€è‡´ï¼Œå†å²å¯å¤ç°ã€‚  
3. [x] DICT/ENTITY è¯­ä¹‰ä¸æ··ç”¨ï¼Œå­˜å‚¨ç­–ç•¥ä¸å±•ç¤ºç­–ç•¥ä¸€è‡´ã€‚  
4. [ ] åˆ—è¡¨ç­›é€‰/æ’åºå‘½ä¸­è‡³å°‘ 1 ä¸ªæ‰©å±•å­—æ®µï¼Œä¸”æ€§èƒ½å¯æ¥å—ã€‚  
5. [x] å­—æ®µé…ç½®å†™å…¥å¯è¿½æº¯åˆ°å•ä¸€ç®¡ç†å…¥å£ï¼ˆæ— ç›´å†™å…ƒæ•°æ®è¡¨ç»•è¡Œï¼‰ã€‚  
6. [x] é—¨ç¦é€šè¿‡ï¼š`make check doc` + å‘½ä¸­çš„ä»£ç /è¿ç§»/æµ‹è¯•é—¨ç¦ã€‚
7. [x] æ— æ•ˆ action/event/target ç»„åˆå¿…æ‹’ç»ï¼ˆfail-closedï¼‰ï¼Œä¸”æœåŠ¡å±‚ç­–ç•¥ä¸ Kernel é˜²å®ˆæ€§æ ¡éªŒå£å¾„ä¸€è‡´ã€‚  
8. [x] mutation capabilities å¯ç¨³å®šè¿”å›â€œå¯ç”¨æ€§ + å­—æ®µæ˜ å°„ + æ‹’ç»åŸå› â€ï¼Œæ‰©å±•å­—æ®µä¸æ ¸å¿ƒå­—æ®µåŒå£å¾„å¯è§£é‡Šã€‚  
9. [x] `PATCH_FIELD_NOT_ALLOWED` ç­‰ç¨³å®šé”™è¯¯ç ä¸å›  UI/Service/Kernel æ¼‚ç§»ã€‚
10. [x] å­—æ®µé…ç½®ç®¡ç†é¡µå¯å‘ç°ã€å¯æ“ä½œä¸”æƒé™æ­£ç¡®ï¼šä»…ç®¡ç†å‘˜å¯å¯ç”¨/åœç”¨å­—æ®µï¼›`physical_col` ç­‰æ˜ å°„ä¿¡æ¯åªè¯»å¯å®¡è®¡ï¼›æ— æƒé™è®¿é—® fail-closedã€‚

## 8. æµ‹è¯•ä¸é—¨ç¦è®¡åˆ’ï¼ˆå¼•ç”¨ SSOTï¼‰

- è§¦å‘å™¨ä¸å‘½ä»¤å…¥å£ä»¥ `AGENTS.md` å’Œ `docs/dev-plans/012-ci-quality-gates.md` ä¸ºå‡†ã€‚  
- æœ¬è®¡åˆ’æ–°å¢ä»£ç åï¼Œè‡³å°‘è¡¥é½ï¼š
  - Kernel SQL å›å½’æµ‹è¯•ï¼ˆå†™å…¥/é‡æ”¾/å¿«ç…§ï¼‰ï¼›
  - å…ƒæ•°æ®ç®¡ç†å…¥å£æµ‹è¯•ï¼ˆå­—æ®µæ–°å¢/å¯åœ/ä¸å¯å¤ç”¨/æƒé™æ‹’ç»ï¼‰ï¼›
  - Service å•æµ‹ï¼ˆç­–ç•¥çŸ©é˜µç»„åˆã€å­—æ®µæ˜ å°„ã€ç±»å‹æ ¡éªŒã€allowlistï¼‰ï¼›
  - API å¥‘çº¦æµ‹è¯•ï¼ˆmutation-capabilities/options/details/listï¼Œå« `deny_reasons`ï¼‰ï¼›
  - E2E ç”¨ä¾‹ï¼ˆå­—æ®µé…ç½®ç®¡ç†é¡µå¯ç”¨ + è¯¦æƒ…é¡µå¯è§/å¯å†™/ç¦ç”¨åŸå› å¯è§£é‡Š + åˆ—è¡¨ç­›é€‰/æ’åºï¼‰ã€‚
- è‹¥å‘½ä¸­ç›¸åº”è§¦å‘å™¨ï¼Œè¡¥è·‘å¹¶è®°å½•ç»“æœï¼š
  - è·¯ç”±ï¼š`make check routing`
  - Authzï¼š`make authz-pack && make authz-test && make authz-lint`
  - sqlcï¼š`make sqlc-generate`ï¼ˆå¹¶éªŒè¯ `git status --short` ä¸ºç©ºï¼‰

## 9. é£é™©æ¸…å•ä¸ç¼“è§£

1. **æ§½ä½è€—å°½**ï¼šå­—æ®µå¢é•¿å¿«äºé¢„ç•™åˆ—ã€‚  
   - ç¼“è§£ï¼šPhase 1 é¢„ç•™å®¹é‡è¯„ä¼° + Phase 5 æ‰©å®¹æµç¨‹ï¼ˆAtlas/Goose é—­ç¯ï¼‰ã€‚
2. **å†å²è¯­ä¹‰æ¼‚ç§»**ï¼šæ˜ å°„è¢«è¯¯æ”¹æˆ–æ§½ä½å¤ç”¨ã€‚  
   - ç¼“è§£ï¼šDB trigger ç¦æ”¹ + æœåŠ¡å±‚ç¦æ­¢å¤ç”¨ + å®¡è®¡å‘Šè­¦ã€‚
3. **åŠ¨æ€ SQL æ¼æ´**ï¼šæ‹¼æ¥åˆ—åå¯¼è‡´æ³¨å…¥é£é™©ã€‚  
   - ç¼“è§£ï¼šåˆ—åä»…æ¥è‡ªå…ƒæ•°æ® allowlistï¼Œå‚æ•°å…¨éƒ¨å ä½ç¬¦ç»‘å®šã€‚
4. **é‡æ”¾å†™æ”¾å¤§åŠ å‰§**ï¼šcorrection/rescind å¯¼è‡´ç‰ˆæœ¬é‡å»ºæˆæœ¬ä¸Šå‡ã€‚  
   - ç¼“è§£ï¼šå…ˆå°èŒƒå›´å­—æ®µã€å†æŒ‰å‹æµ‹ç»“æœè¿­ä»£ä¼˜åŒ–é‡æ”¾è·¯å¾„ã€‚

## 10. ä¾èµ–å…³ç³»ä¸å¹¶è¡Œç­–ç•¥

- å¼ºä¾èµ–ï¼š`098 -> 100A(Phase 0) -> 100B(Phase 1) -> 100C(Phase 2) -> 100D(Phase 3) -> 100 Phase 4`ã€‚
- å¯å¹¶è¡Œï¼šPhase 3ï¼ˆAPIï¼‰ä¸ Phase 4ï¼ˆUIï¼‰å¯éƒ¨åˆ†å¹¶è¡Œï¼Œä½†å¿…é¡»åœ¨ Phase 2 å‡ºå£ååˆå¹¶ã€‚
- è´¨é‡æ”¶å£ï¼šPhase 5 åœ¨ Phase 3/4 åŠŸèƒ½é—­ç¯åç»Ÿä¸€æ‰§è¡Œã€‚

## 11. ä»£ç è½ç‚¹ï¼ˆé¢„åˆ†é…ï¼‰

- Schema/å‡½æ•°ï¼š`modules/orgunit/infrastructure/persistence/schema/`  
- å†™æœåŠ¡ï¼š`modules/orgunit/services/orgunit_write_service.go`ï¼ˆåŠæ–°å»º metadata è¾…åŠ©æ–‡ä»¶ï¼‰  
- APIï¼š`internal/server/orgunit_api.go`ã€`internal/server/orgunit_nodes.go`  
- æµ‹è¯•ï¼š
  - `internal/server/orgunit_api_test.go`
  - `internal/server/orgunit_nodes_test.go`
  - `internal/server/orgunit_nodes_read_test.go`
  - `internal/server/orgunit_audit_snapshot_schema_test.go`

## 12. å…³è”æ–‡æ¡£

- `docs/dev-plans/100a-org-metadata-wide-table-phase0-contract-freeze-readiness.md`
- `docs/dev-plans/100b-org-metadata-wide-table-phase1-schema-and-metadata-skeleton.md`
- `docs/dev-plans/100c-org-metadata-wide-table-phase2-kernel-projection-extension-one-door.md`
- `docs/dev-plans/100d-org-metadata-wide-table-phase3-service-and-api-read-write.md`
- `docs/dev-plans/100e-org-metadata-wide-table-phase4a-orgunit-details-capabilities-editing.md`
- `docs/dev-plans/100g-org-metadata-wide-table-phase4c-orgunits-list-ext-query-i18n-closure.md`
- `docs/dev-plans/100h-org-metadata-wide-table-phase5-stability-performance-ops-closure.md`
- `docs/archive/dev-plans/101-orgunit-field-config-management-ui-ia.md`
- `docs/archive/dev-plans/098-org-module-wide-table-metadata-driven-architecture-assessment.md`
- `docs/archive/dev-plans/083-org-whitelist-extensibility-capability-matrix-plan.md`
- `docs/dev-plans/080c-orgunit-audit-snapshot-presence-table-constraint-plan.md`
- `docs/dev-plans/032-effective-date-day-granularity.md`
- `docs/dev-plans/021-pg-rls-for-org-position-job-catalog.md`
- `docs/dev-plans/012-ci-quality-gates.md`
- `AGENTS.md`
